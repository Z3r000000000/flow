import{_ as C}from"./sidebar-aae7d28d.js";import{_ as b,o as l,c as r,a as e,m as n,v as c,F as f,l as P,p as y,j as k,s as _,t as h,q as U,u as M,b as m}from"./index-748fe450.js";const S={name:"AddProduct",data(){return{product:{title:"",price:0,description:"",images:[]}}},methods:{addImage(){this.product.images.push({url:""})},removeImage(){fetch("https://8962a1eb5edc700e.mokky.dev/items",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.product)})},saveProduct(){fetch("https://8962a1eb5edc700e.mokky.dev/items",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.product)}).then(o=>{o.ok?(console.log("Товар сохранен успешно"),this.product={title:"",price:0,description:"",images:[{url:""}]},window.location.reload()):console.error("Ошибка при сохранении товара")}).catch(o=>{console.error("Ошибка при сохранении товара:",o)})}}},u=o=>(y("data-v-f403f7b4"),o=o(),k(),o),V={class:"add-product"},T={class:"product-form"},N=u(()=>e("h2",null,"Добавление Товара",-1)),O={class:"form-group"},j=u(()=>e("label",{for:"title"},"Название:",-1)),L={class:"form-group"},A=u(()=>e("label",{for:"price"},"Цена:",-1)),B={class:"form-group"},D=u(()=>e("label",{for:"description"},"Описание:",-1)),E={class:"form-group"},$=u(()=>e("label",null,"Изображения:",-1)),F=["onUpdate:modelValue"],J=["onClick"];function q(o,d,v,x,s,i){return l(),r("div",V,[e("div",T,[N,e("div",O,[j,n(e("input",{type:"text",id:"title","onUpdate:modelValue":d[0]||(d[0]=t=>s.product.title=t)},null,512),[[c,s.product.title]])]),e("div",L,[A,n(e("input",{type:"number",id:"price","onUpdate:modelValue":d[1]||(d[1]=t=>s.product.price=t)},null,512),[[c,s.product.price]])]),e("div",B,[D,n(e("textarea",{style:{resize:"none",width:"100%",height:"150px"},id:"description","onUpdate:modelValue":d[2]||(d[2]=t=>s.product.description=t)},null,512),[[c,s.product.description]])]),e("div",E,[$,(l(!0),r(f,null,P(s.product.images,(t,p)=>(l(),r("div",{key:p,class:"image-input"},[n(e("input",{type:"text","onUpdate:modelValue":g=>t.url=g,placeholder:"URL изображения"},null,8,F),[[c,t.url]]),e("button",{onClick:g=>i.removeImage(p)},"Удалить",8,J)]))),128)),e("button",{onClick:d[3]||(d[3]=(...t)=>i.addImage&&i.addImage(...t)),class:"add-image-btn"},"Добавить Изображение")]),e("button",{onClick:d[4]||(d[4]=(...t)=>i.saveProduct&&i.saveProduct(...t)),class:"save-btn"},"Сохранить")])])}const I=b(S,[["render",q],["__scopeId","data-v-f403f7b4"]]);const z={name:"ProductTable",data(){return{products:[],showModal:!1,editedProduct:{id:null,title:"",price:0,description:"",images:[]}}},mounted(){this.fetchProducts()},methods:{fetchProducts(){_.get("https://8962a1eb5edc700e.mokky.dev/items").then(o=>{this.products=o.data}).catch(o=>{console.error("Ошибка при получении товаров:",o)})},getImageUrl(o){return`https://8962a1eb5edc700e.mokky.dev/itemsimage?carId=${o}`},showEditModal(o){this.editedProduct={...o},this.showModal=!0},closeModal(){this.showModal=!1,this.editedProduct={id:null,title:"",price:0,images:[]}},addImage(){this.editedProduct.images.push(null)},removeImage(o){this.editedProduct.images.splice(o,1)},handleImageUpload(o,d){this.editedProduct.images[d]=o.target.files[0]},saveProduct(){const o={title:this.editedProduct.title,price:this.editedProduct.price,description:this.editedProduct.description,images:this.editedProduct.images};_.patch(`https://8962a1eb5edc700e.mokky.dev/items/${this.editedProduct.id}`,o).then(()=>{console.log("Товар обновлен успешно"),this.fetchProducts(),this.closeModal()}).catch(d=>{console.error("Ошибка при обновлении товара:",d),alert("Произошла ошибка при обновлении товара. Пожалуйста, попробуйте еще раз.")})},deleteProduct(o){window.confirm("Вы действительно хотите удалить этот товар?")&&_.delete(`https://8962a1eb5edc700e.mokky.dev/items/${o}`).then(()=>{console.log("Товар успешно удален"),this.fetchProducts()}).catch(d=>{console.error("Ошибка при удалении товара:",d)})}}},a=o=>(y("data-v-96f14f34"),o=o(),k(),o),R={class:"list-table"},G={class:"product-table"},H=a(()=>e("h2",null,"Список Товаров",-1)),K={class:"table-wrapper"},Q=a(()=>e("thead",null,[e("tr",null,[e("th",null,"Название"),e("th",null,"Цена"),e("th",null,"Описание"),e("th",null,"Действия")])],-1)),W={class:"description-cell"},X={class:"description-wrapper"},Y=["onClick"],Z=["onClick"],ee={key:0,class:"modal"},te={class:"modal-content"},oe=a(()=>e("label",{for:"title"},"Название:",-1)),de=a(()=>e("label",{for:"price"},"Цена:",-1)),se=a(()=>e("label",{for:"description"},"Описание:",-1)),ie=a(()=>e("h3",null,"Изображения",-1)),le={class:"image-upload"},re=a(()=>e("button",{type:"submit"},"Сохранить",-1));function ne(o,d,v,x,s,i){return l(),r("div",R,[e("div",G,[H,e("div",K,[e("table",null,[Q,e("tbody",null,[(l(!0),r(f,null,P(s.products,t=>(l(),r("tr",{key:t.id},[e("td",null,h(t.title),1),e("td",null,h(t.price),1),e("td",W,[e("div",X,h(t.description),1)]),e("td",null,[e("button",{onClick:p=>i.showEditModal(t)},"Редактировать",8,Y),e("button",{onClick:p=>i.deleteProduct(t.id)},"Удалить",8,Z)])]))),128))])])])]),s.showModal?(l(),r("div",ee,[e("div",te,[e("span",{class:"close-button",onClick:d[0]||(d[0]=(...t)=>i.closeModal&&i.closeModal(...t))},"×"),e("h2",null,h(s.editedProduct.id?"Редактирование товара":"Создание нового товара"),1),e("form",{onSubmit:d[5]||(d[5]=U((...t)=>i.saveProduct&&i.saveProduct(...t),["prevent"]))},[oe,n(e("input",{type:"text",id:"title","onUpdate:modelValue":d[1]||(d[1]=t=>s.editedProduct.title=t)},null,512),[[c,s.editedProduct.title]]),de,n(e("input",{type:"number",id:"price","onUpdate:modelValue":d[2]||(d[2]=t=>s.editedProduct.price=t)},null,512),[[c,s.editedProduct.price]]),se,n(e("textarea",{id:"description","onUpdate:modelValue":d[3]||(d[3]=t=>s.editedProduct.description=t)},null,512),[[c,s.editedProduct.description]]),ie,e("div",le,[e("input",{type:"text",onChange:d[4]||(d[4]=(...t)=>i.handleImageUpload&&i.handleImageUpload(...t))},null,32)]),re],32)])])):M("",!0)])}const w=b(z,[["render",ne],["__scopeId","data-v-96f14f34"]]),ce={name:"AdminShop",components:{AddItem:I,ItemList:w}},pe=Object.assign(ce,{setup(o){return(d,v)=>(l(),r(f,null,[m(C),m(I),m(w)],64))}});export{pe as default};
